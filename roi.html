<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
<link href="css/styles.css" rel="stylesheet"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>ุญุงุณุจุฉ ุงูุนุงุฆุฏ (ROI) ูุชุฑุดูุฏ ุงูุทุงูุฉ ุงูููุฒููุฉ | HEAO</title>
<meta content="ุญุงุณุจุฉ ุณุฑูุนุฉ ูุชูุฏูุฑ ุงูุชูููุฑ ุงูุดูุฑู ููุชุฑุฉ ุงูุงุณุชุฑุฏุงุฏ ูุฎุฏูุงุช ุชุฏููู ุงูุทุงูุฉ ุงูููุฒููุฉ ูู HEAO." name="description"/>
<link href="assets/favicon.png" rel="icon"/>
<meta content="ุญุงุณุจุฉ ุงูุนุงุฆุฏ (ROI) ูุชุฑุดูุฏ ุงูุทุงูุฉ ุงูููุฒููุฉ | HEAO" property="og:title"/>
<meta content="ุฃุฏุฎู ูุนูููุงุช ููุฒูู ูุดุงูุฏ ุงูุชูููุฑ ุงูุดูุฑู ููุชุฑุฉ ุงูุงุณุชุฑุฏุงุฏ ููุฑูุง." property="og:description"/>
<meta content="assets/heao-logo.jpg" property="og:image"/>
<style>
    :root{
      --bg:#0f172a;
      --card:#111827;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --accent:#22c55e;
      --accent-2:#f59e0b;
      --danger:#ef4444;
      --border:#1f2937;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";}
    .container{max-width:1050px;margin:0 auto;padding:24px;}
    .header{display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;margin-bottom:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo-wrap{width:48px;height:48px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:#0b1220;border:1px solid var(--border);overflow:hidden}
    .logo-wrap img{width:100%;height:100%;object-fit:contain}
    .h1{font-size:1.35rem;margin:0}
    .sub{color:var(--muted);font-size:.95rem}
    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:18px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px}
    .card h2{margin-top:0;margin-bottom:10px;font-size:1.1rem}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    .row-1{display:grid;grid-template-columns:1fr;gap:12px}
    label{display:block;font-size:.92rem;margin-bottom:6px;color:var(--muted)}
    input,select,button,textarea{width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:#0b1220;color:var(--text);font-size:1rem}
    input::placeholder{color:#64748b}
    .muted{color:var(--muted);font-size:.9rem}
    .badge{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);padding:8px 12px;border-radius:999px;background:#0b1220}
    .kpis{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:10px}
    .kpi{background:#0b1220;border:1px solid var(--border);padding:14px;border-radius:12px}
    .kpi .label{color:var(--muted);font-size:.85rem}
    .kpi .value{font-size:1.35rem;margin-top:6px}
    .progress{height:10px;background:#0b1220;border:1px solid var(--border);border-radius:999px;overflow:hidden;margin-top:10px}
    .progress>span{display:block;height:100%;background:linear-gradient(90deg,#22c55e,#16a34a);width:0%}
    .cta{display:flex;gap:10px;align-items:center;margin-top:10px}
    .pill{padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:#0b1220;color:var(--muted);font-size:.85rem}
    .ok{color:#052b10;background:rgba(34,197,94,.2);border-color:#14532d}
    .warn{color:#4a2a05;background:rgba(245,158,11,.2);border-color:#713f12}
    .no{color:#3f0b0b;background:rgba(239,68,68,.2);border-color:#7f1d1d}
    .actions{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
    .btn{cursor:pointer;background:linear-gradient(135deg,#22c55e,#16a34a);border:none;color:#052b10;font-weight:700}
    .btn-outline{background:transparent;border:1px solid var(--border);color:#e5e7eb}
    .small{font-size:.9rem}
    .list{margin:0;padding-right:18px}
    .footer{margin-top:18px;color:var(--muted);font-size:.85rem}
    .sep{height:1px;background:var(--border);margin:14px 0}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}
    /* Success bar style */
    .success{background:rgba(34,197,94,.15);border:1px solid #14532d;color:#bbf7d0;padding:10px 12px;border-radius:12px;margin-top:12px;display:none}
  
/* Light override to match site */
body{background:#f7fafc;color:#0b1014}
.card{background:#ffffff;color:#0b1014;border:1px solid #e6eef5}
.h1,.h2,.h3,.h4,h1,h2,h3,h4{color:#0b1014}
.muted{color:#586a78}
.header{background:#ffffff;border-bottom:1px solid #e6eef5}
.btn{color:#052b10}

  </style>
</head>
<body>
<header class="header" id="home">
<div class="container header-inner">
<a class="logo" href="#home">
<img alt="HEAO logo" class="logo-glow" src="assets/logo.png"/>
<h1>HEAO โ Home Energy Advisory Office</h1>
</a>
<nav class="nav">
<a data-i="nav-home" href="#home">ุงูุฑุฆูุณูุฉ</a>
<a data-i="nav-services" href="#services">ุงูุฎุฏูุงุช</a>
<a data-i="nav-process" href="#process">ุขููุฉ ุงูุนูู</a>
<a data-i="nav-research" href="#research">ุงูุฃุจุญุงุซ</a>
<a href="roi.html">ุงูุญุงุณุจุฉ</a>
<a data-i="nav-pricing" href="#pricing">ุงูุจุงูุงุช</a>
<a data-i="nav-faq" href="#faq">ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ</a>
<a data-i="nav-contact" href="#contact">ุงูุญุฌุฒ</a>
<button aria-label="Switch to English" class="btn secondary" id="lang-en">EN</button>
<button aria-label="ุงูุชุจุฏูู ุฅูู ุงูุนุฑุจูุฉ" class="btn secondary" id="lang-ar">ุน</button>
<a class="btn" data-i="cta-book" href="#contact">ุงุญุฌุฒ ุฒูุงุฑุฉ</a>
</nav>
</div>
</header>
<div class="container">
<div class="header">
<div class="brand"><a class="btn btn-outline" href="index.html" style="margin-left:10px">ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>
<div aria-label="HEAO logo" class="logo-wrap">
<img alt="Home Energy Advisory Office" src="assets/heao-logo.jpg"/>
</div>
<div>
<h1 class="h1">ุญุงุณุจุฉ ุงูุนุงุฆุฏ (ROI) ูุชุฑุดูุฏ ุงูุทุงูุฉ ุงูููุฒููุฉ</h1>
<div class="sub">ุฃุฏุฎู ุจูุงูุงุช ุดูุชู/ูููุงูุชู ูุงุญุตู ุนูู ุชูุฏูุฑ ููุฑู ููุชูููุฑ ุงูุดูุฑู ููุชุฑุฉ ุงูุงุณุชุฑุฏุงุฏุ ูุน ุชูุตูุงุช ุณุฑูุนุฉ ูุฎูุงุฑ ุญุฌุฒ ุฒูุงุฑุฉ ุชุฏููู ุทุงูุฉ.</div>
</div>
</div>
<div class="badge">
<span>โก</span><span>ูุณุฎุฉ ุฅุทูุงู ุณุฑูุนุฉ โ ุฌุงูุฒุฉ ููุฑูุน ุนูู Netlify</span>
</div>
</div>
<div class="grid">
<div class="card">
<h2>ุงููุฏุฎูุงุช ุงูุฃุณุงุณูุฉ</h2>
<div class="row">
<div>
<label>ููุน ุงูุณูู</label>
<select id="dwelling" name="dwelling">
<option value="apartment">ุดูุฉ</option>
<option value="villa">ูููุง</option>
</select>
</div>
<div>
<label>ุงููุณุงุญุฉ (ูยฒ)</label>
<input id="area" max="1200" min="20" name="area" placeholder="ูุซุงู: 140" step="10" type="number"/>
</div>
</div>
<div class="row">
<div>
<label>ูุชูุณุท ุงููุงุชูุฑุฉ ุงูุดูุฑูุฉ (ุฑ.ุณ)</label>
<input id="bill" min="50" name="bill" placeholder="ูุซุงู: 850" step="10" type="number"/>
</div>
<div>
<label>ุนุฏุฏ ุงูููููุงุช</label>
<input id="acs" max="30" min="0" name="acs" placeholder="ูุซุงู: 5" step="1" type="number"/>
</div>
</div>
<div class="row">
<div>
<label>ุฌูุฏุฉ ุงูุนุฒู</label>
<select id="insulation" name="insulation">
<option value="good">ุฌูุฏ</option>
<option value="medium">ูุชูุณุท</option>
<option value="poor">ุถุนูู</option>
<option selected="" value="unknown">ุบูุฑ ูุนุฑูู</option>
</select>
</div>
<div>
<label>ุงูููุงูุฐ ูุฒุฏูุฌุฉุ</label>
<select id="windows" name="windows">
<option value="yes">ูุนู</option>
<option selected="" value="no">ูุง</option>
<option value="unknown">ุบูุฑ ูุนุฑูู</option>
</select>
</div>
</div>
<div class="row">
<div>
<label>ุงูุฅูุงุฑุฉ</label>
<select id="lighting" name="lighting">
<option value="all_led">ูููุง LED</option>
<option selected="" value="some_led">ุจุนุถูุง LED</option>
<option value="old">ูุฏููุฉ/ูููุฑุณูุช</option>
<option value="unknown">ุบูุฑ ูุนุฑูู</option>
</select>
</div>
<div>
<label>ุณุฎุงู ุงููุงุก ูุน ูุคูุชุ</label>
<select id="heater" name="heater">
<option value="always">ุฏุงุฆูุงู</option>
<option value="sometimes">ุฃุญูุงูุงู</option>
<option selected="" value="never">ูุง</option>
<option value="none">ูุง ููุฌุฏ</option>
</select>
</div>
</div>
<div class="row">
<div>
<label>ุดุฏุฉ ุงุณุชุฎุฏุงู ุงูุชูููู</label>
<select id="acIntensity" name="acIntensity">
<option value="low">ููุฎูุถ</option>
<option selected="" value="medium">ูุชูุณุท</option>
<option value="high">ุนุงูู</option>
</select>
</div>
<div>
<label>ุณุนุฑ ุฒูุงุฑุฉ ุงูุชุฏููู (ูุงุจู ููุชุนุฏูู)</label>
<input id="auditPrice" min="100" name="auditPrice" placeholder="ููุญุชุณุจ ุชููุงุฆูุงู ุญุณุจ ุงูููุน/ุงููุณุงุญุฉ" step="10" type="number"/>
</div>
</div>
<div class="actions">
<button class="btn" id="calc" type="button">ุงุญุณุจ ุงูุนุงุฆุฏ ุงูุขู</button>
<button class="btn btn-outline" id="reset" type="button">ุฅุนุงุฏุฉ ุงูุถุจุท</button>
</div>
<div class="footer">
<div class="sep"></div>
<div class="muted small">ููุงุญุธุฉ: ุงูุชูุฏูุฑุงุช ุชูุฑูุจูุฉ ูุบุฑุถ ุงููุนู ูุงุชุฎุงุฐ ุงููุฑุงุฑ ุงูุฃููู. ุงูุฃุฑูุงู ูุฏ ุชุฎุชูู ุญุณุจ ุงูุณูููุ ุงูุฃุฌูุฒุฉุ ูุญุงูุฉ ุงููุจูู ุงููุนููุฉ.</div>
</div>
</div>
<div aria-live="polite" class="card" id="resultsCard">
<h2>ุงููุชุงุฆุฌ</h2>
<div class="kpis">
<div class="kpi">
<div class="label">ูุณุจุฉ ุงูุชูููุฑ ุงููุชููุนุฉ</div>
<div class="value"><span id="savePct">โ</span></div>
</div>
<div class="kpi">
<div class="label">ุชูููุฑ ุดูุฑู ุชูุฏูุฑู</div>
<div class="value"><span id="saveSar">โ</span> ุฑ.ุณ</div>
</div>
<div class="kpi">
<div class="label">ูุชุฑุฉ ุงูุงุณุชุฑุฏุงุฏ</div>
<div class="value"><span id="payback">โ</span> ุฃุดูุฑ</div>
</div>
<div class="kpi">
<div class="label">ุชุตููู ุงูุฌุฏูู</div>
<div class="value"><span id="viability">โ</span></div>
</div>
</div>
<div class="progress"><span id="roiBar"></span></div>
<div class="cta">
<span class="pill" id="leadBadge">โ</span>
<span class="pill" id="billBadge">โ</span>
</div>
<div class="sep"></div>
<h3 style="margin-top:0">ุฃูุถู 3 ุชูุตูุงุช ููุฑูุฉ</h3>
<ol class="list" id="recs">
<li>โ</li>
</ol>
<div class="sep"></div>
<h3 style="margin-top:0">ุงุญุฌุฒ ุฒูุงุฑุฉ</h3>
<!-- Netlify Forms ready -->
<form action="mailto:hello@heao.sa" class="row" id="leadForm" method="GET" name="leadForm">
<input name="form-name" type="hidden" value="leadForm"/>
<p style="display:none">
<label>ูุง ุชุนุจุฆ ูุฐุง ุงูุญูู: <input name="bot-field"/></label>
</p>
<div>
<label>ุงูุงุณู ุงููุงูู</label>
<input id="name" name="name" placeholder="ุงูุงุณู" required="" type="text"/>
</div>
<div>
<label>ุงูุฌูุงู</label>
<input id="phone" name="phone" placeholder="05xxxxxxxx" required="" type="tel"/>
</div>
<div>
<label>ุงููุฏููุฉ</label>
<input id="city" name="city" placeholder="ุงูุฑูุงุถ / ุฌุฏุฉ / ุงูุฏูุงู" required="" type="text"/>
</div>
<div>
<label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ุงุฎุชูุงุฑู)</label>
<input id="email" name="email" placeholder="you@example.com" type="email"/>
</div>
<div class="row-1">
<label class="muted"><input id="consent" name="consent" style="width:auto;display:inline-block;margin-left:8px" type="checkbox"/> ุฃูุงูู ุนูู ุชูุงุตู HEAO ูุนู ุจุดุฃู ุงูุฒูุงุฑุฉ.</label>
</div>
<!-- Hidden fields to store outputs for Netlify -->
<input id="h_savePct" name="savePct" type="hidden"/>
<input id="h_saveSar" name="saveSar" type="hidden"/>
<input id="h_payback" name="payback" type="hidden"/>
<input id="h_viability" name="viability" type="hidden"/>
<input id="h_calc_inputs" name="calc_inputs" type="hidden"/>
<input id="h_ts" name="timestamp" type="hidden"/>
<div class="actions">
<button class="btn" type="submit">ุงุญุฌุฒ ุงูุขู</button>
<button class="btn btn-outline" id="exportBtn" type="button">ุชุตุฏูุฑ ุชูุฑูุฑ PDF</button>
</div>
<div class="success" id="localSuccess">ุชู ุงุณุชูุงู ุทูุจู ูุญูููุง. ุงุฑุจุทู ุจูุธุงูู ูุงุญููุง ุฃู ุงุฑูุนู ุนูู Netlify ูุงูุชูุงุท ุงูุจูุงูุงุช ุชููุงุฆููุง.</div>
<div class="muted small">ูู ูุจูุน ุจูุงูุงุชู. ููุงุณุชุฎุฏุงู ุงูุฏุงุฎูู ููุท.</div>
</form>
</div>
</div>
<div class="footer">
<div class="sep"></div>
<div>ยฉ 2025 HEAO โ Home Energy Advisory Office</div>
</div>
</div>
<script>
(function(){
  const $ = (id)=>document.getElementById(id);
  const fields = ["dwelling","area","bill","acs","insulation","windows","lighting","heater","acIntensity","auditPrice"];
  const formEls = fields.map($);
  const results = {savePct:$("savePct"), saveSar:$("saveSar"), payback:$("payback"), viability:$("viability"), roiBar:$("roiBar"), leadBadge:$("leadBadge"), billBadge:$("billBadge"), recs:$("recs")};

  function defaultAuditPrice(){
    const dwelling = $("dwelling").value || "apartment";
    const area = +($("area").value||0);
    let price = dwelling==="apartment" ? 349 : 649;
    if(area>250 && area<=400) price += 200;
    if(area>400) price += 400;
    return price;
  }

  function clamp(v,min,max){return Math.max(min,Math.min(max,v));}

  function compute(){
    const bill = +($("bill").value||0);
    const acs = +($("acs").value||0);
    const insulation = $("insulation").value;
    const windows = $("windows").value;
    const lighting = $("lighting").value;
    const heater = $("heater").value;
    const acIntensity = $("acIntensity").value;

    let acShare = acIntensity==="low" ? 0.5 : acIntensity==="high" ? 0.75 : 0.6;

    let s = [];
    if(insulation==="medium") s.push(0.07*acShare);
    if(insulation==="poor")   s.push(0.14*acShare);
    if(insulation==="unknown")s.push(0.10*acShare);
    if(windows==="no") s.push(0.06*acShare);
    if(windows==="unknown") s.push(0.03*acShare);
    if(acs>=1 && acs<=3) s.push(0.02*acShare);
    if(acs>=4)           s.push(0.04*acShare);
    if(lighting==="some_led") s.push(0.04);
    if(lighting==="old")      s.push(0.07);
    if(lighting==="unknown")  s.push(0.03);
    if(heater==="sometimes") s.push(0.03);
    if(heater==="never")     s.push(0.05);
    s.push((acIntensity==="low"?0.05:acIntensity==="high"?0.12:0.08)*acShare);

    let combined = 1 - s.reduce((acc,si)=>acc*(1-si),1);
    const combinedCap = 0.40;
    const optimistic = clamp(combined*1.1, 0, combinedCap);
    const conservative = clamp(combined*0.6, 0, 0.30);
    const mid = clamp((optimistic+conservative)/2, 0, 0.35);

    const saveSar = bill>0 ? Math.round(bill * mid) : 0;
    const savePctStr = bill>0 ? Math.round(mid*100)+"%" : "โ";

    let auditPrice = +($("auditPrice").value||0);
    if(!auditPrice){ auditPrice = defaultAuditPrice(); $("auditPrice").value = auditPrice; }

    const payback = (saveSar>0) ? Math.ceil(auditPrice / saveSar) : null;

    let viability = "ุฃุฏุฎู ุงูุจูุงูุงุช";
    let pillClass = "pill";
    if(payback!==null){
      if(payback<=3){ viability="ุฌุฏุงู ูุฌุฏู"; pillClass="pill ok"; }
      else if(payback<=6){ viability="ูุฌุฏู"; pillClass="pill warn"; }
      else { viability="ูุฏ ูุง ูููู ูุฌุฏูุงู"; pillClass="pill no"; }
    }

    const billBadge = (bill>=700) ? "ูุงุชูุฑุชู ูุฑุชูุนุฉ (700+ ุฑ.ุณ)" : "ูุงุชูุฑุฉ ุถูู ุงูุทุจูุนู (<700 ุฑ.ุณ)";
    const leadBadge = (payback!==null && payback<=6) ? "ุนููู ุณุงุฎู ๐ฅ" : "ุจุญุงุฌุฉ ูุชูุนูุฉ";

    const maxMonths = 12;
    const pct = payback ? clamp((maxMonths - Math.min(payback,maxMonths))/maxMonths * 100, 0, 100) : 0;
    results.roiBar.style.width = pct + "%";

    results.savePct.textContent = savePctStr;
    results.saveSar.textContent = saveSar ? saveSar.toLocaleString('ar-EG') : "โ";
    results.payback.textContent = payback!==null ? payback : "โ";
    results.viability.textContent = viability;
    results.leadBadge.textContent = leadBadge;
    results.leadBadge.className = pillClass;
    results.billBadge.textContent = billBadge;
    results.billBadge.className = "pill";

    const recs = [];
    if(insulation!=="good") recs.push("ูุญุต ุงูุนุฒู ุงูุญุฑุงุฑู ูุณุฏ ุงูุชุณุฑูุจุงุช ุญูู ุงูููุงูุฐ ูุงูุฃุจูุงุจ.");
    if(heater!=="always" && heater!=="none") recs.push("ุชุฑููุจ ูุคูุช/ุชุงููุฑ ูุณุฎุงู ุงููุงุก ูุถุจุทู ุนูู ุณุงุนุงุช ุงูุฐุฑูุฉ ููุท.");
    if(lighting!=="all_led") recs.push("ุงุณุชุจุฏุงู ุงูุฅูุงุฑุฉ ุงููุชุจููุฉ ุจู LED ุนุงููุฉ ุงูููุงุกุฉ.");
    if(acs>=4) recs.push("ุชูุธูู ููุงุชุฑ ููุนุงูุฑุฉ ุงูููููุงุช ูุถุจุท ุฏุฑุฌุงุช ุงูุญุฑุงุฑุฉ ุนูู 24โ26ยฐ ูุฆูู.");
    if(windows!=="yes") recs.push("ุชุญุณูู ุงูููุงูุฐ (ุฒุฌุงุฌ ูุฒุฏูุฌ/ุนูุงุฒู) ูู ุงูุบุฑู ุงูุฃูุซุฑ ุงุณุชุฎุฏุงูุงู.");
    if(recs.length===0) recs.push("ูุฑุงุฌุนุฉ ุณููู ุงูุงุณุชุฎุฏุงู ูุชุซุจูุช ุฌุฏุงูู ุชุดุบูู/ุฅุทูุงุก ููุฃุฌูุฒุฉ ุฐุงุช ุงูุงุณุชููุงู ุงูุนุงูู.");
    $("recs").innerHTML = recs.slice(0,3).map(r=>`<li>${r}</li>`).join("");

    const data = Object.fromEntries(fields.map(id=>[id,$(id).value]));
    localStorage.setItem("heao_roi_v1", JSON.stringify(data));

    // update hidden fields for Netlify submissions
    $("h_savePct").value = results.savePct.textContent;
    $("h_saveSar").value = results.saveSar.textContent;
    $("h_payback").value = results.payback.textContent;
    $("h_viability").value = results.viability.textContent;
    $("h_calc_inputs").value = JSON.stringify(data);
    $("h_ts").value = new Date().toISOString();
  }

  function initPersisted(){
    const raw = localStorage.getItem("heao_roi_v1");
    if(!raw) return;
    try{
      const data = JSON.parse(raw);
      fields.forEach(id=>{ if(data[id]!==undefined) $(id).value = data[id]; });
    }catch(e){}
  }

  function reset(){
    fields.forEach(id=>$(id).value = "");
    $("dwelling").value = "apartment";
    $("insulation").value = "unknown";
    $("windows").value = "no";
    $("lighting").value = "some_led";
    $("heater").value = "never";
    $("acIntensity").value = "medium";
    $("auditPrice").value = "";
    localStorage.removeItem("heao_roi_v1");
    compute();
  }

  function exportPDF(){
    window.print();
  }

  // Submit: allow Netlify to capture when deployed there; otherwise keep local
  $("leadForm").addEventListener("submit", function(e){
    const onNetlify = /\.netlify\.(app|live)$/i.test(location.hostname);
    if(onNetlify){
      // Let the form post normally (Netlify will capture)
      return true;
    }
    // Local fallback: store lead and show success
    e.preventDefault();
    if(!$("consent").checked){ alert("ูุฑุฌู ุงูููุงููุฉ ุนูู ุงูุชูุงุตู ุฃููุงู."); return; }
    const payload = {
      name: $("name").value.trim(),
      phone: $("phone").value.trim(),
      city: $("city").value.trim(),
      email: $("email").value.trim(),
      consent: $("consent").checked,
      inputs: Object.fromEntries([
        ["dwelling",$("dwelling").value],
        ["area",$("area").value],
        ["bill",$("bill").value],
        ["acs",$("acs").value],
        ["insulation",$("insulation").value],
        ["windows",$("windows").value],
        ["lighting",$("lighting").value],
        ["heater",$("heater").value],
        ["acIntensity",$("acIntensity").value],
        ["auditPrice",$("auditPrice").value],
      ]),
      outputs: {
        savePct: $("savePct").textContent,
        saveSar: $("saveSar").textContent,
        payback: $("payback").textContent,
        viability: $("viability").textContent
      },
      ts: new Date().toISOString()
    };
    const leads = JSON.parse(localStorage.getItem("heao_roi_leads")||"[]");
    leads.push(payload);
    localStorage.setItem("heao_roi_leads", JSON.stringify(leads));
    $("localSuccess").style.display = "block";
    this.reset();
    $("consent").checked = false;
  });

  $("calc").addEventListener("click", compute);
  $("exportBtn").addEventListener("click", exportPDF);
  $("reset").addEventListener("click", reset);
  formEls.forEach(el=>el.addEventListener("change", compute));
  ["dwelling","area"].forEach(id=>$(id).addEventListener("change", ()=>{
    if(!$("auditPrice").value){ $("auditPrice").value = defaultAuditPrice(); }
  }));

  initPersisted();
  compute();
})();
</script>
<script src="js/main.js"></script>
</body>
</html>
